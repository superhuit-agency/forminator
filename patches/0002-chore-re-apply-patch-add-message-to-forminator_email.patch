From e75216aa515c9e6bbee4418144fe94544fc2ce39 Mon Sep 17 00:00:00 2001
From: Felipe Paul Martins <felipe@superhuit.ch>
Date: Thu, 12 Feb 2026 15:55:59 +0100
Subject: [PATCH 2/2] =?UTF-8?q?chore:=20=F0=9F=92=A5=20re-apply=20patch:?=
 =?UTF-8?q?=20add=20message=20to=20forminator=5Femail=5Fmessage=20&=20loop?=
 =?UTF-8?q?=20through=20notification=20in=20object?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 library/abstracts/abstract-class-mail.php         | 3 ++-
 library/modules/custom-forms/front/front-mail.php | 5 ++---
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/library/abstracts/abstract-class-mail.php b/library/abstracts/abstract-class-mail.php
index 33edecf..4b7bc0b 100644
--- a/library/abstracts/abstract-class-mail.php
+++ b/library/abstracts/abstract-class-mail.php
@@ -389,8 +389,9 @@ abstract class Forminator_Mail {
 		 * Filter email body that will be sent by Forminator Mailer
 		 *
 		 * @param string $message
+		 * @param string $original_message
 		 */
-		$message = apply_filters( 'forminator_email_message', $message );
+		$message = apply_filters( 'forminator_email_message', $message, $this->message );
 
 		$this->message = $message;
 	}
diff --git a/library/modules/custom-forms/front/front-mail.php b/library/modules/custom-forms/front/front-mail.php
index 4058417..cf5b61a 100644
--- a/library/modules/custom-forms/front/front-mail.php
+++ b/library/modules/custom-forms/front/front-mail.php
@@ -122,7 +122,6 @@ class Forminator_CForm_Front_Mail extends Forminator_Mail {
 
 		try {
 			$data          = Forminator_CForm_Front_Action::$prepared_data;
-			$notifications = $custom_form->notifications;
 
 			if (
 			empty( $data ) && ! empty( $submitted_data ) &&
@@ -191,10 +190,10 @@ class Forminator_CForm_Front_Mail extends Forminator_Mail {
 			do_action( 'forminator_custom_form_mail_before_send_mail', $this, $custom_form, $data, $entry );
 
 			// Process Email.
-			if ( ! empty( $notifications ) ) {
+			if ( ! empty( $custom_form->notifications ) ) {
 				$this->init();
 				// Process admin mail.
-				foreach ( $notifications as $notification ) {
+				foreach ( $custom_form->notifications as $notification ) {
 
 					// If notification is save_draft type, skip.
 					if (
-- 
2.52.0

